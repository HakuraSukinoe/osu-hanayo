(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{20:function(t,e,s){t.exports=s("832j")},"832j":function(t,e,s){"use strict";s.r(e);var n=s("/cCk"),a=s("0h6b"),o=s("YLtl"),i=s("l+Wg"),r=s("cDcd"),c=s("R6iF"),l=s("XFVs");class d extends r.Component{constructor(t){super(t),this.eventId=`news-index-${osu.uuid()}`,this.componentDidMount=()=>{$(document).on(`turbolinks:before-cache.${this.eventId}`,this.saveState)},this.componentWillUnmount=()=>{$(document).off(`.${this.eventId}`)},this.newStateFromData=t=>{const e=t.news_posts.length===t.search.limit;let s,n;return null==this.state?(s=[],n=!1):(s=this.state.posts,n=this.state.loading),s=s.concat(t.news_posts),e&&s.pop(),{posts:s,hasMore:e,loading:n}},this.restoreState=()=>{const t=this.props.container.dataset.lastState;null!=t&&(this.state=JSON.parse(t),delete this.props.container.dataset.lastState)},this.saveState=()=>{this.props.container.dataset.lastState=JSON.stringify(this.state)},this.showMore=()=>{if(!this.state.hasMore)return;if(0===this.state.posts.length)return;const t={cursor:{},limit:21},e=o.last(this.state.posts);null!=e&&(t.cursor.id=e.id,t.cursor.published_at=e.published_at),this.setState({loading:!0}),$.get(Object(a.route)("news.index"),t).done(t=>{this.setState(this.newStateFromData(t))}).always(()=>{this.setState({loading:!1})})},this.restoreState(),null==this.state&&(this.state=this.newStateFromData(t.data))}render(){return r.createElement(r.Fragment,null,r.createElement(i.a,{section:"index",title:osu.trans("news.index.title.info")}),r.createElement("div",{className:"osu-page osu-page--news"},r.createElement("div",{className:"news-index"},this.state.posts.map((t,e)=>{let s="news-index__item";return 0===e&&(s+=" news-index__item--first"),r.createElement("div",{key:t.id,className:s},r.createElement(l.a,{post:t}))}),r.createElement("div",{className:"news-index__item news-index__item--more"},r.createElement(c.a,{callback:this.showMore,hasMore:this.state.hasMore,loading:this.state.loading,modifiers:["t-dark-purple-dark"]})))),r.createElement(n.a,{items:[{component:"button",icon:"fas fa-sync",props:{"data-method":"post","data-reload-on-success":"1","data-remote":!0,"data-url":Object(a.route)("news.store"),type:"button"},text:osu.trans("news.store.button")}]}))}}reactTurbolinks.registerPersistent("news-index",d,!0,t=>({container:t,data:osu.parseJson("json-index")}))},NzAu:function(t,e){t.exports=ReactDOMFactories},YLtl:function(t,e){t.exports=_},cDcd:function(t,e){t.exports=React},wy2R:function(t,e){t.exports=moment}},[[20,0]]]);
//# sourceMappingURL=news-index.js.map