(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{21:function(e,t,n){e.exports=n("CPtx")},CPtx:function(e,t,n){"use strict";n.r(t);var s=n("/cCk"),a=n("2LKk"),o=n("w9NC"),r=n("0h6b"),c=n("YLtl"),l=n("wy2R"),i=n("l+Wg"),p=n("cDcd");class m extends p.Component{constructor(){super(...arguments),this.contentContainer=p.createRef(),this.processContent=()=>{let e=this.props.post.content;null==e&&(e="");const t=document.createElement("div");t.innerHTML=e;const n=t.querySelector("img");let s;null!=n&&null!=n.parentElement&&n.parentElement.remove();const a=c.last(t.querySelectorAll("p"));return null!=a&&null!=a.textContent&&null!=a.textContent.match(/^[—–][^—–]/)&&(s=a.textContent.slice(1)),{content:e=t.innerHTML,author:s}},this.renderHeader=({author:e})=>{let t,n;return null!=e&&(t=p.createElement("div",{className:"news-card__author"},osu.trans("news.show.by",{user:e}))),null!=this.props.post.first_image&&(n=p.createElement("img",{className:"news-card__cover",src:this.props.post.first_image})),p.createElement("div",{className:"news-card news-card--show"},n,p.createElement("div",{className:"news-card__overlay"}),p.createElement("div",{className:"news-card__content"},p.createElement("div",{className:"news-card__time js-tooltip-time",title:this.props.post.published_at},l(this.props.post.published_at).format("ll")),p.createElement("div",{className:"news-card__main"},p.createElement("div",{className:"news-card__title"},this.props.post.title),t)))},this.renderNav=()=>{if(null==this.props.post.navigation)return;let e,t;const n=this.props.post.navigation.newer,s=this.props.post.navigation.older;return null!=n&&(e=p.createElement("a",{className:"page-nav__link",href:Object(r.route)("news.show",{news:n.slug}),title:n.title},p.createElement("span",{className:"page-nav__label"},osu.trans("news.show.nav.newer")),p.createElement("span",{className:"fas fa-chevron-right"}))),null!=s&&(t=p.createElement("a",{className:"page-nav__link",href:Object(r.route)("news.show",{news:s.slug}),title:s.title},p.createElement("span",{className:"fas fa-chevron-left"}),p.createElement("span",{className:"page-nav__label"},osu.trans("news.show.nav.older")))),p.createElement("div",{className:"page-nav"},p.createElement("div",{className:"page-nav__item page-nav__item--left"},t),p.createElement("div",{className:"page-nav__item page-nav__item--right"},e))}}componentDidMount(){const e=this.contentContainer.current;if(!e)return;const t=e.getElementsByTagName("audio");c.each(t,e=>{e.volume=.45})}render(){const{content:e,author:t}=this.processContent();return p.createElement(p.Fragment,null,p.createElement(i.a,{section:"show",post:this.props.post,title:osu.trans("news.show.title.info")}),p.createElement("div",{className:"osu-page osu-page--news"},p.createElement("div",{className:"news-show"},this.renderHeader({author:t}),p.createElement("div",{ref:this.contentContainer,dangerouslySetInnerHTML:{__html:e}}),p.createElement("div",{className:"news-show__nav"},this.renderNav()))),p.createElement("div",{className:"osu-page osu-page---compact"},p.createElement(o.a,{commentableType:"news_post",commentableId:this.props.post.id,component:a.a,componentProps:{modifiers:["changelog"]}})),p.createElement(s.a,{items:[{component:"a",icon:"fab fa-github",props:{href:this.props.post.edit_url},text:osu.trans("wiki.show.edit.link")},{component:"button",icon:"fas fa-sync",props:{"data-method":"put","data-reload-on-success":1,"data-remote":!0,"data-url":Object(r.route)("news.update",{news:this.props.post.id}),type:"button"},text:osu.trans("news.update.button")}]}))}}reactTurbolinks.registerPersistent("news-show",m,!0,e=>({container:e,post:osu.parseJson("json-show")}))},NzAu:function(e,t){e.exports=ReactDOMFactories},YLtl:function(e,t){e.exports=_},cDcd:function(e,t){e.exports=React},faye:function(e,t){e.exports=ReactDOM},wy2R:function(e,t){e.exports=moment}},[[21,0]]]);
//# sourceMappingURL=news-show.js.map